%G = [ 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.013167, -0.013167, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.162696, 0.162696, 0.016052, 0.016052, 0.200821, 0.139821, 0.060033, 0.020078, 0.020078, 0.113957, 0.113957, 0.060460, 0.060460, 0.124449, 0.124449, 0.160317, 0.160317, 0.049663, 0.049663, 0.050334, 0.050334, 0.167698, 0.167698, -0.018962, 0.087361, 0.093644, 0.112066, 0.112066, 0.084250, 0.084250, 0.092302, 0.092302, 0.056922, 0.056922, 0.050151, 0.050151, 0.074673, 0.074673, -0.035005, -0.035005, 0.000000, 0.000000, -0.096981, -0.096981, 0.061131, 0.033315, -0.071544, 0.052957, -0.031223, -0.009690, -0.009690, -0.010849, -0.010849, -0.106375, -0.106375, -0.057453, -0.057453, 0.082542, 0.082542, 0.017455, 0.017455, 0.020505, 0.020505, 0.000000, 0.000000, 0.026056, 0.046491, -0.025977, 0.021054, 0.021054, -0.062882, -0.062882, -0.060625, -0.060625, -0.117538, -0.117538, -0.068555, -0.068555, -0.042325, -0.042325, -0.184638, -0.184638, -0.034883, -0.034883, -0.187932, -0.137180, -0.041471, -0.036835, -0.036835, -0.133093, -0.133093, -0.081670, -0.081670, -0.054525, -0.054525, -0.052146, -0.052146, 0.000000, 0.000000, -0.081487, -0.081487, -0.055074, -0.055074, -0.075875, -0.096737, -0.090759, -0.083195, -0.083195, -0.012740, -0.012740, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.088154, 0.088154, 0.000000, 0.000000, 0.017089, 0.017089, 0.027215, 0.027215, -0.018413, -0.018413, -0.079230, -0.079230, -0.059893, -0.059893, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.005725, -0.005725, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.008000];
G =[0.046360, 0.035380, 0.037576, 0.036112, 0.036844, 0.034404, 0.034160, 0.037088, 0.038552, 0.038796, 0.041480, 0.033672, 0.037088, 0.036112, 0.037088, 0.035868, 0.036844, 0.036112, 0.035136, 0.035624, 0.036112, 0.035136, 0.037576, 0.037820, 0.037088, 0.037332, 0.035136, 0.033916, 0.034404, 0.036600, 0.038552, 0.036600, 0.035624, 0.035136, 0.035868, 0.037820, 0.038552, 0.039284, 0.038552, 0.037576, 0.034160, 0.033672, 0.036112, 0.038552, 0.149084, 0.121756, 0.128344, 0.116632, 0.157624, 0.210084, 0.244976, 0.125416, 0.159576, 0.178120, 0.122732, 0.146156, 0.136396, 0.164944, 0.116388, 0.112484, 0.153232, 0.091744, 0.138836, 0.114192, 0.104920, 0.115900, 0.048556, 0.090280, 0.054168, 0.034648, 0.018056, -0.010248, 0.012932, 0.051728, -0.008052, -0.010736, -0.005612, -0.050264, -0.021960, -0.033428, -0.037088, -0.068076, -0.075884, -0.134200, -0.136884, -0.185196, -0.224480, -0.218380, -0.238632, -0.155672, -0.107360, 0.024888, 0.036600, 0.038064, 0.038796, 0.037088, 0.038064, 0.035868, 0.034404, 0.034648, 0.036844, 0.039284, 0.039528, 0.035624, 0.034648, 0.034160, 0.033916, 0.038552, 0.039528, 0.038552, 0.036600, 0.032452, 0.034648, 0.036600, 0.040016, 0.038064, 0.036844, 0.035868, 0.034648, 0.036844, 0.036844, 0.037332, 0.039040, 0.041968, 0.039040, 0.034160, 0.032940, 0.035624, 0.036844, 0.040016, 0.040504, 0.037332, 0.034648, 0.032452, 0.031964, 0.035380, 0.040016, 0.040992, 0.040260, 0.036600, 0.034648, 0.032452, 0.034892, 0.038552, 0.039040, 0.039772, 0.037088, 0.033428, 0.034648, 0.033672, 0.037576, 0.040992, 0.039772, 0.036600, 0.034648, 0.033672, 0.034892, 0.036600, 0.040748, 0.037088, 0.038796, 0.035380, 0.038064, 0.041968, 0.039284, 0.036356, 0.036600, 0.037820, 0.044652];
%ms =length(G)*12.24

ms =length(G)*15.2
tiempo = ms/1000;
fm = length(G)/tiempo; %Frecuencia de muestreo
%Se define el eje de tiempo.
t = 0:1/fm:tiempo;
%Definicion de la escala de frecuencias para la FFT
Af = fm /(length(t)-1);  %Incrementos de frecuencia a tiempo 1.
dts = fm-Af;           %Barrido de frecuencias a t1.
xf = 0:Af:dts;%Escala de Frecuencia a t1 (numero de puntos impar)

 
%Visualizacion de la senal completa y su FFT
%Plot de la senal en dominio temporal.
figure(gcf);
subplot(3,1,1);
plot(G);
title ('Aceleraci?n [G]'),
xlabel('Time (ms)'), grid on, axis ( [0 inf -inf inf] )
hold on

%FILTRO pasa bajos FIR:

% All frequency values are in Hz.

N     = 100;  % Order
Fpass = 3;    % Passband Frequency
Fstop = 6;  % Stopband Frequency
Wpass = 1;    % Passband Weight
Wstop = 80;   % Stopband Weight

% Calculate the coefficients using the FIRLS function.
lpf  = firls(N, [0 Fpass Fstop fm/2]/(fm/2), [1 1 0 0], [Wpass Wstop]);

%Plot de la se?al filtrada.
filtrado_lpf = conv(G,lpf, 'same');
plot (filtrado_lpf,'r');
hold off

%Plot de la FFT.
subplot(3,1,2);  
DTF = abs (fft(G))/length(xf);
plot (xf-((fm/2)-(Af/2)),fftshift(DTF),'b');
title ('Signal FFT'),
xlabel('Frec (Hz)'), grid on, axis ( [0 inf -inf inf] )

%Calculo de velocidad y posicion. Como se trabaja en terminos discretizados
%se utiliza el metodo de MLU
%v = V0 + int(a?dt) = v0 +a?t
%r = R0 + int(v*dt)

%Inicilizacion de Vector de velocidades instantaneas
vel=0;
dist = 0;
vel (1) = filtrado_lpf(1)*9.8*(1/fm);
vel (2) = filtrado_lpf(2)*9.8*(1/fm);
for i = 3:(length(G))
    if abs(filtrado_lpf(i)) < 0.0001
        vel (i) = 0;
    else
        vel(i) =filtrado_lpf(i)*9.8*(1/fm)+((vel(i-1)+vel(i-2))/2); %Velocidad inicial + (G[m/s2]*[s]) = [m/s]
    end
end;
%Vector de distancia
dist (1) = vel (1)*(1/fm);
for i = 2:length(G)
    dist(i) = vel(i)*(1/fm) + dist(i-1);
end;
subplot(3,1,3);
hold on
plot (vel,'r');
plot (dist,'g');
title ('Velocidad - Distancia'),
xlabel('Tiempo (ms)'), grid on, axis ( [0 inf -inf inf] )



