G = [0.034953, 0.037759, 0.037759, 0.034526, 0.033794, 0.033123, 0.034648, 0.035929, 0.035380, 0.035441, 0.040321, 0.036112, 0.036905, 0.036539, 0.034648, 0.033428, 0.033489, 0.033245, 0.036051, 0.035502, 0.035136, 0.034648, 0.033855, 0.033184, 0.035197, 0.035258, 0.035014, 0.032330, 0.033489, 0.034892, 0.035563, 0.034709, 0.033306, 0.032513, 0.034038, 0.035807, 0.036966, 0.034892, 0.034770, 0.034404, 0.033550, 0.033489, 0.033306, 0.033977, 0.036112, 0.034892, 0.033062, 0.031659, 0.032635, 0.030744, 0.035746, 0.040931, 0.036966, 0.018361, 0.028487, 0.032147, 0.037027, 0.038308, 0.032757, 0.016592, 0.028609, 0.031354, 0.033001, 0.033794, 0.034648, 0.034404, 0.033489, 0.033672, 0.031110, 0.030683, 0.031537, 0.016104, 0.034587, 0.037027, 0.038308, 0.033794, 0.028304, 0.027084, 0.045018, 0.033794, 0.037454, 0.037149, 0.034892, 0.032940, 0.016226, 0.031171, 0.032574, 0.034892, 0.035624, 0.032818, 0.031049, 0.033123, 0.032086, 0.033672, 0.038857, 0.038857, 0.031537, 0.027267, 0.029463, 0.033916, 0.036112, 0.038674, 0.038369, 0.033062, 0.027206, 0.025132, 0.029890, 0.037515, 0.041297, 0.039345, 0.033306, 0.017324, 0.029768, 0.032147, 0.104920, 0.193248, 0.101199, 0.129198, 0.133834, 0.145058, 0.138531, 0.133712, 0.120292, 0.153781, 0.138104, 0.235399, 0.163175, 0.148840, 0.179218, 0.165920, 0.131211, 0.125599, 0.134017, 0.131882, 0.133407, 0.134261, 0.145302, 0.145058, 0.118401, 0.144021, 0.105469, 0.058499, 0.064416, 0.068869, 0.001037, 0.005917, -0.009028, -0.033428, -0.049898, -0.067100, -0.123891, -0.116754, -0.169153, -0.204960, -0.210694, -0.176900, -0.150304, -0.125050, -0.120170, -0.163480, -0.144448, -0.092354, -0.024705, -0.018300, -0.013176, -0.029158, -0.060085, -0.077043, -0.081923, 0.028975, 0.033184, 0.041358, 0.038125, 0.036112, 0.034648, 0.032757, 0.033367, 0.034282, 0.035380, 0.034221, 0.033428, 0.034343, 0.034160, 0.033977, 0.033489, 0.036356, 0.035563, 0.034831, 0.033855, 0.033916, 0.034465, 0.036295, 0.036600, 0.037027, 0.037820, 0.034587, 0.035197, 0.032147, 0.034099, 0.035929, 0.037637, 0.035990, 0.035441, 0.034282, 0.034038, 0.036844, 0.035929, 0.058743, 0.042517, 0.037698, 0.035502, 0.035563, 0.035868, 0.036905, 0.038430, 0.038003, 0.036417, 0.035441, 0.035380, 0.035014, 0.037637, 0.040504, 0.037332, 0.034160, 0.034465, 0.037271, 0.037881, 0.036966, 0.037393, 0.033977, 0.037576, 0.031415, 0.035197, 0.033733, 0.297192, 0.152256, 0.093330, 0.148047, 0.176168, 0.110227, 0.154330, 0.140178, 0.108885, 0.156770, 0.155062, 0.154391, 0.173118, 0.152439, 0.142435, 0.147742, 0.102114, 0.057828, 0.076067, 0.045994, 0.015555, 0.014030, 0.049288, -0.013969, -0.064111, -0.040504, -0.060939, -0.079056, -0.132004, -0.176717, -0.169275, -0.188917, -0.150121, -0.202825, -0.119194, 0.021228, 0.035441, 0.024400, 0.023851, 0.048251, 0.041114, 0.019947, 0.042029, 0.046055, 0.039040, 0.036600, 0.031293, 0.034526, 0.035380, 0.035441, 0.036844, 0.036905, 0.036295, 0.035441, 0.033062, 0.035441, 0.034953, 0.035807, 0.034953, 0.032391, 0.034648, 0.037271, 0.037332, 0.035929, 0.033733, 0.033367, 0.038308, 0.039345, 0.037332, 0.033245, 0.032330, 0.035075, 0.036539, 0.035624, 0.034831, 0.036539, 0.035502, 0.036112, 0.035075, 0.035807, 0.036966, 0.037820, 0.038369, 0.035441, 0.031964, 0.032757, 0.035990, 0.038796, 0.037027, 0.036295, 0.034221, 0.035014, 0.036295, 0.037393, 0.037515, 0.036051, 0.036539, 0.035624, 0.035685, 0.034343, 0.035563, 0.035929, 0.035807, 0.036783, 0.035624, 0.035258, 0.034282, 0.035929, 0.036600, 0.037210, 0.034038, 0.033489, 0.033245, 0.034526, -0.025498, -0.023241, 0.031781, -0.014335, 0.060573, -0.023912, 0.004514, -0.017629, -0.022143, -0.029646, -0.032757, 0.009943, -0.048373, -0.046299, -0.040321, -0.026474, 0.001647, -0.049715, -0.012017, -0.055632, -0.018178, -0.002013, 0.015128, -0.023058, 0.005307, 0.005490, 0.032696, -0.004148, 0.002074, 0.044225, -0.005002, 0.022082, 0.003416, 0.077958, -0.003416, 0.054351, 0.036173, 0.078690, 0.054473, 0.102297, 0.041785, 0.123403, 0.166896, 0.155062, 0.166347, 0.168482, 0.203313, 0.168055, 0.193919, 0.178303, 0.120963, 0.071736, 0.034404, 0.032513, 0.030988, 0.033367, 0.035685, 0.037759, 0.036051, 0.034831, 0.033245, 0.035624, 0.036539, 0.035014, 0.036966, 0.037881, 0.035929, 0.035502, 0.033306, 0.034892, 0.037027, 0.038308, 0.035380, 0.032818, 0.033977, 0.035136, 0.037820, 0.036539, 0.035624, 0.035075, 0.034038, 0.033306, 0.033306, 0.034770, 0.036722, 0.037637, 0.036478, 0.034648, 0.034282, 0.036234, 0.038186, 0.038491, 0.036844, 0.033855, 0.033184, 0.031720, 0.034221, 0.039101, 0.043493, 0.038918, 0.026657, 0.046421, 0.031964, 0.038247, 0.039650, 0.035929, 0.034831, 0.034160, 0.035258, 0.034770, 0.033977, 0.035197, 0.035746, 0.036051, 0.034953, 0.035075, 0.033672, 0.036234, 0.034892, 0.037332, 0.038857, 0.036844, 0.029524, -0.099613, -0.050752, -0.037332, -0.088694, -0.037088, -0.074542, -0.056059, -0.129320, -0.118828, -0.098637, -0.089914, -0.060634, -0.065697, -0.044286, -0.072468, -0.082716, -0.069479, -0.039162, -0.061000, -0.038613, 0.018849, 0.002074, -0.030256, -0.004514, -0.041602, -0.064477, -0.040382, 0.018971, -0.041419, -0.052460, -0.042883, 0.022814, 0.045384, 0.056303, 0.098759, 0.067405, 0.087352, 0.066612, 0.130418, 0.201056, 0.256017, 0.318054, 0.424560, 0.347761, 0.249307, 0.215879, 0.125050, 0.154818, 0.175619, 0.205509, 0.127429, 0.104981, 0.037698, 0.038735, 0.036173, 0.037088, 0.039223, 0.037393, 0.037088, 0.036478, 0.030744, 0.029219, 0.032940, 0.043798, 0.047702, 0.044591, 0.035807, 0.028060, 0.028365, 0.033245, 0.036783, 0.040687, 0.043371, 0.039589, 0.032452, 0.028426, 0.032391, 0.038796, 0.041785, 0.041541, 0.038430, 0.033367, 0.035868, 0.033245, 0.034282, 0.037149, 0.037393, 0.034221, 0.031110, 0.029646, 0.032086, 0.036173, 0.038552, 0.037820, 0.034465, 0.029097, 0.031659, 0.032269, 0.036417, 0.037759, 0.035197, 0.025071, 0.029585, 0.020008, 0.032818, 0.032025, 0.026474, 0.032147, 0.032086, 0.046848, 0.032330, 0.031232, 0.031659, 0.032208, 0.030744, 0.031232, 0.015799, 0.031720, 0.030378, 0.029646, 0.030073, 0.031903, 0.046604, 0.032391, 0.032269, 0.031049, 0.030683, 0.030012, 0.031232, 0.032025, 0.032208, 0.032452, 0.032940, 0.031659, 0.030317, 0.032696, 0.033367, 0.033489, 0.031537, 0.031781, 0.031598, 0.032086, 0.031293, 0.031537, 0.030988, 0.033550, 0.031964, 0.031415, 0.031293, 0.031903, 0.032574, 0.031720, 0.033062, 0.031598, 0.031720, 0.032086, 0.031049, 0.046726, 0.032330, 0.033123, 0.032086, 0.030683, 0.032757, 0.032757, 0.032818, 0.032513, 0.031171, 0.031476, 0.032696, 0.033550, 0.033794, 0.032147, 0.032513, 0.032391, 0.033062, 0.031720, 0.032757, 0.032940, 0.033367, 0.031842, 0.046787, 0.031354, 0.056791, 0.028365, 0.033001, 0.033245, 0.033672, 0.033184, 0.033367, 0.032635, 0.032330, 0.031903, 0.046848, 0.032391, 0.021411, 0.030622, 0.031659, 0.032818, 0.032147, 0.031903, 0.031781, 0.033001, 0.032696, 0.032574, 0.045811, 0.032452, 0.033062];
%G = [0.035270, 0.035214, 0.035238, 0.035301, 0.035367, 0.035425, 0.035444, 0.035416, 0.035387, 0.035266, 0.035239, 0.035238, 0.035138, 0.035149, 0.035318, 0.035521, 0.035956, 0.036404, 0.036885, 0.037340, 0.037588, 0.037846, 0.037966, 0.037936, 0.037705, 0.037311, 0.036856, 0.036426, 0.036040, 0.035777, 0.035648, 0.035558, 0.035696, 0.035655, 0.035615, 0.035594, 0.035568, 0.035592, 0.035573, 0.035593, 0.035641, 0.035672, 0.035692, 0.035675, 0.035715, 0.035781, 0.035730, 0.035654, 0.035750, 0.035874, 0.035987, 0.036212, 0.036439, 0.036683, 0.036969, 0.037185, 0.037357, 0.037424, 0.037350, 0.037068, 0.036685, 0.036331, 0.036011, 0.035644, 0.035316, 0.035085, 0.035027, 0.035019, 0.034918, 0.034964, 0.035122, 0.035228, 0.035300, 0.035327, 0.035240, 0.035158, 0.034988, 0.034771, 0.034568, 0.034417, 0.034275, 0.034081, 0.034005, 0.034168, 0.034245, 0.034336, 0.034465, 0.034510, 0.034494, 0.034485, 0.034463, 0.034393, 0.034337, 0.034272, 0.034167, 0.034066, 0.033927, 0.033831, 0.033743, 0.033690, 0.033735, 0.033860, 0.034007, 0.034126, 0.034190, 0.034238, 0.034219, 0.034167, 0.034036, 0.033836, 0.033622, 0.033432, 0.033302, 0.033210, 0.033225, 0.033253, 0.033378, 0.033384, 0.033443, 0.033498, 0.033526, 0.033568, 0.033618, 0.033604, 0.033706, 0.033705, 0.033693, 0.033605, 0.033463, 0.033255, 0.032999, 0.032707, 0.032413, 0.032277, 0.032217, 0.032254, 0.032359, 0.032522, 0.032721, 0.032850, 0.032961, 0.033043, 0.033103, 0.033157, 0.033055, 0.033117, 0.033185, 0.033269, 0.033333, 0.033499, 0.033549, 0.033524, 0.033454, 0.033276, 0.033050, 0.032793, 0.032519, 0.032270, 0.032088, 0.032019, 0.032022, 0.032126, 0.032315, 0.032578, 0.032849, 0.033065, 0.033261, 0.033376, 0.033432, 0.033321, 0.033346, 0.033340, 0.033335, 0.033326, 0.033372, 0.033386, 0.033437, 0.033454, 0.033447, 0.033416, 0.033423, 0.033375, 0.033312, 0.033254, 0.033183, 0.033123, 0.033056, 0.033014, 0.032998, 0.032993, 0.033001, 0.032988, 0.033018, 0.033032, 0.033043, 0.033072, 0.033107, 0.033155, 0.033173, 0.033260, 0.033294, 0.033356, 0.033437, 0.033498, 0.033539, 0.033576, 0.033587, 0.033606, 0.033566, 0.033524, 0.033454, 0.033420, 0.033363, 0.033359, 0.033385, 0.033420, 0.033476, 0.033543, 0.033623, 0.033656, 0.033692, 0.033701, 0.033647, 0.033565, 0.033497, 0.033383, 0.033283, 0.033223, 0.033223, 0.033277, 0.033369, 0.033472, 0.033607, 0.033690, 0.033745, 0.033802, 0.033771, 0.033693, 0.033616, 0.033510, 0.033405, 0.033296, 0.033218, 0.033122, 0.033047, 0.033003, 0.033700, 0.035178, 0.036558, 0.037422, 0.036328, 0.033935, 0.028845, 0.022563, 0.015518, 0.006836, -0.001737, -0.008774, -0.014248, -0.015906, -0.014993, -0.012212, -0.008486, -0.003787, 0.000449, 0.003567, 0.005440, 0.005230, 0.005891, 0.005612, 0.006014, 0.005357, 0.006420, 0.006860, 0.007263, 0.009815, 0.012338, 0.014741, 0.016580, 0.014541, 0.011814, 0.010398, 0.009505, 0.009186, 0.011024, 0.015251, 0.019779, 0.026961, 0.032943, 0.038653, 0.040795, 0.041853, 0.040511, 0.037949, 0.038358, 0.039966, 0.042475, 0.046148, 0.051213, 0.057755, 0.061844, 0.060054, 0.055894, 0.049293, 0.042321, 0.036692, 0.034187, 0.033538, 0.034030, 0.038130, 0.047806, 0.058268, 0.070533, 0.084504, 0.095112, 0.104528, 0.110992, 0.112055, 0.109138, 0.100086, 0.088169, 0.075280, 0.061747, 0.049713, 0.040251, 0.033301, 0.029641, 0.029213, 0.032140, 0.034102, 0.033111, 0.031913, 0.032452, 0.032732, 0.032578, 0.032426, 0.032353, 0.032324, 0.032362, 0.032402, 0.032462, 0.032496, 0.032562, 0.032586, 0.032660, 0.032755, 0.032872, 0.032991, 0.033129, 0.033205, 0.033265, 0.033274, 0.033259, 0.033217, 0.033185, 0.033168, 0.033153, 0.033130, 0.033156, 0.033159, 0.033195, 0.033230, 0.033182, 0.033146, 0.033059, 0.032995, 0.032926, 0.032872, 0.032852, 0.032858, 0.032859, 0.032879, 0.032898, 0.032910, 0.032907, 0.032887, 0.032845, 0.032760, 0.032649, 0.032573, 0.032482, 0.032414, 0.032392, 0.032360, 0.032347, 0.032303, 0.032306, 0.032333, 0.032358, 0.032413, 0.032507, 0.032610, 0.032699, 0.032783, 0.032826, 0.032856, 0.032851, 0.032839, 0.032761, 0.032646, 0.032563, 0.032514, 0.032494, 0.032502, 0.032551, 0.032629, 0.032674, 0.032685, 0.032671, 0.032669, 0.032634, 0.032629, 0.032656, 0.032696, 0.032764, 0.032818, 0.032870, 0.032915, 0.032922, 0.032913, 0.032899, 0.032881, 0.032857, 0.032856, 0.032776, 0.032722, 0.032668, 0.032633, 0.032608, 0.032571, 0.032570, 0.032611, 0.032713, 0.032817, 0.032935, 0.033059, 0.033146, 0.033176, 0.033129, 0.032997, 0.032826, 0.032655, 0.032504, 0.032375, 0.032284, 0.032201, 0.032172, 0.032159, 0.032216, 0.032307, 0.032391, 0.032505, 0.032606, 0.032689, 0.032717, 0.032728, 0.032734, 0.032617, 0.032627, 0.032557, 0.032411, 0.032114, 0.032200, 0.032198, 0.032282, 0.032376, 0.032491, 0.032623, 0.032704, 0.032803, 0.032885, 0.032935, 0.032982, 0.033023, 0.033049, 0.033072, 0.033103, 0.033307, 0.033273, 0.033401, 0.033560, 0.033747, 0.033454, 0.033547, 0.033611, 0.033647, 0.033680, 0.033688, 0.033676, 0.033639, 0.033614, 0.033596, 0.033581, 0.033533, 0.033619, 0.033683, 0.033734, 0.033845, 0.033972, 0.034061, 0.034071, 0.034040, 0.033969, 0.033797, 0.033630, 0.033456, 0.033318, 0.033226, 0.033253, 0.033306, 0.033469, 0.033696, 0.033970, 0.034291, 0.034417, 0.034618, 0.034733, 0.034764, 0.034651, 0.034491, 0.034293, 0.034061, 0.033785, 0.033625, 0.033464, 0.033383, 0.033366, 0.033469, 0.033658, 0.033942, 0.034198, 0.034497, 0.034786, 0.035055, 0.035245, 0.035332, 0.035355, 0.035281, 0.035162, 0.034986, 0.034744, 0.034488, 0.034272, 0.034099, 0.034000, 0.033983, 0.034035, 0.034143, 0.034277, 0.034443, 0.034605, 0.034730, 0.034833, 0.034910, 0.034962, 0.035026, 0.035060, 0.035078, 0.035090, 0.035083, 0.035029, 0.034945, 0.034862, 0.034787, 0.034706, 0.034664, 0.034644, 0.034632, 0.034667, 0.034694, 0.034732, 0.034727, 0.034736, 0.034729, 0.034772, 0.034822, 0.034873, 0.034963, 0.035053, 0.035096, 0.035115, 0.035097, 0.035053, 0.034970, 0.034905, 0.034838, 0.034794, 0.034822, 0.034895, 0.034985, 0.035110, 0.035238, 0.035363];
ms =length(G)*15.2
tiempo = ms/1000;
fm = length(G)/tiempo; %Frecuencia de muestreo
%Se define el eje de tiempo.
t = 0:1/fm:tiempo;
%Definicion de la escala de frecuencias para la FFT
Af = fm /(length(t)-1);  %Incrementos de frecuencia a tiempo 1.
dts = fm-Af;           %Barrido de frecuencias a t1.
xf = 0:Af:dts;%Escala de Frecuencia a t1 (numero de puntos impar)

 
%Visualizacion de la senal completa
%Plot de la senal en dominio temporal.
figure(gcf);
subplot(3,1,1);
plot(G,'r');
title ('Aceleraci?n [G]'),
xlabel('Time (ms)'), grid on, axis ( [0 inf -inf inf] )
hold on

%Ventana del filtro:

rectwin = [ones(1,length(G))];
rectwin (1) = 0;
%Filtrado de la continua:

G_FFT = fft(G);
Ffiltrado = G_FFT .* rectwin;
Tfiltrado = ifft(Ffiltrado,'symmetric');
plot (Tfiltrado);

%Se filtra con un pasa altos la se?al sin el nivel de continua.

N     = 100;  % Order
Fpass = 4;    % Passband Frequency
Fstop = 5;    % Stopband Frequency
Wpass = 1;    % Passband Weight
Wstop = 20;   % Stopband Weight

% Calculate the coefficients using the FIRLS function.
lpf  = firls(N, [0 Fpass Fstop fm/2]/(fm/2), [1 1 0 0], [Wpass Wstop]);

%Se aplica el filtro pasa bajos
Tlpffiltrado = conv(Tfiltrado,lpf,'same');
plot (Tlpffiltrado,'g');

%Plot de la FFT de la se?al.
subplot(3,1,2);  
DTF = abs (G_FFT)/length(xf);
plot (xf-((fm/2)-(Af/2)),fftshift(DTF),'b');
title ('Signal FFT'),
xlabel('Frec (Hz)'), grid on, axis ( [0 inf -inf inf] )

%Calculo de la velocidad

vel=0;

vel (1) = Tlpffiltrado(1)*9.8*(1/fm);
for i = 2:(length(G))
   vel(i) =Tlpffiltrado(i)*9.8*(1/fm)+vel(i-1); %Velocidad inicial + (G[m/s2]*[s]) = [m/s]
end;
%Vector de distancia
dist = 0;
dist (1) = vel (1)*(1/fm);
for i = 2:length(G)
    dist(i) = vel(i)*(1/fm) + dist(i-1);
end;
subplot(3,1,3);
hold on
plot (vel,'r');
plot (dist,'g');
title ('Velocidad - Distancia'),
xlabel('Tiempo (ms)'), grid on, axis ( [0 inf -inf inf] )




